# タイピング練習アプリ 仕様書

## 1. 概要

本アプリケーションは、段階的にタイピングスキルを習得することを目的とした教育用Webアプリケーションである。ホームポジションの基礎練習から始まり、単語、短文、そして最終的には日常会話レベルの文章入力まで、体系的に学習を進めることができる。

## 2. 機能仕様

### 2.1. 画面構成

本アプリは主に3つの画面で構成される。

1.  **レッスン選択画面 (`#lesson-menu`)**
    *   アプリケーションの初期画面。
    *   全6レベルの学習コースがカード形式で表示される。
    *   各コースのアンロック状態（ロック中、開始可能、クリア済み）が視覚的に表示される。

2.  **学習画面 (`#learning-area`)**
    *   タイピング練習を行うメイン画面。
    *   以下の要素で構成される:
        *   **問題表示エリア**: 日本語の問題文、ひらがなの読み、入力すべきローマ字が表示される。
        *   **入力フォーム**: ユーザーがタイピングを行うテキストボックス。
        *   **仮想キーボード**: 次に打つべきキーがハイライトされる。
        *   **フィンガーガイド**: 使用すべき指がハイライトされる。
        *   **ステータスパネル**: 正解数、ミス数、正答率、進捗状況がリアルタイムで表示される。
        *   **タイマー/失敗カウンター (レベル6のみ)**: 制限時間と連続失敗回数が表示される。

3.  **結果画面 (`#result-screen`)**
    *   レッスン終了後に表示される。
    *   総入力数、正解数、最終的な正答率、苦手なキーなどが表示される。
    *   クリア条件を満たしたかどうかに応じて、メッセージが変化する。
    *   「もう一度挑戦」「次のレベルへ」「メニューに戻る」といったアクションボタンが配置される。

### 2.2. レッスンシステム

*   レッスンは全6レベルで構成される。
*   **進捗とアンロック**:
    *   レベル1は初期状態でアンロックされている。
    *   各レベルにはクリア条件として**最低正答率**が設定されている。
    *   この条件を満たしてクリアすると、次のレベルがアンロックされる。
*   **レッスンデータ**:
    *   各レベルのタイトル、説明、問題内容（文字、単語、文章）、クリア条件は `script.js` 内の `this.lessons` オブジェクトで一元管理されている。
    *   日本語の単語・文章には、複数のローマ字表記（例: `shigoto` / `sigoto`）が `alternatives` として定義されており、どちらの入力も正解として判定される。

| レベル | タイトル | 内容 | 問題数 | クリア条件 (正答率) | 特記事項 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | ホームポジション | 基本的なアルファベット | 20 | 80% | |
| 2 | 基本文字 | 主要なアルファベット | 20 | 85% | |
| 3 | 全文字 | 全てのアルファベット | 20 | 90% | |
| 4 | 日本語単語 | 簡単な日本語単語 | 20 | 85% | |
| 5 | 長めの単語 | 複雑な日本語単語 | 20 | 80% | |
| 6 | 日常会話 | 実践的な日本語文章 | 30 | 90% | 制限時間、ゲームオーバーあり |

### 2.3. 学習フロー

1.  ユーザーはレッスン選択画面から挑戦したいコースを選ぶ。
2.  学習画面に遷移し、最初の問題が出題される。
3.  ユーザーは表示された問題に対応するローマ字を入力する。
4.  入力が完了、または1文字入力されるごとに正誤が判定される。
    *   **正解**: 「正解！」というフィードバックが表示され、自動的に次の問題に進む。正解数がカウントアップされる。
    *   **不正解**: 「もう一度！」などのフィードバックが表示される。入力がリセットされ、同じ問題に再挑戦する。ミス数がカウントアップされる。
5.  規定の問題数を完了すると、結果画面に遷移する。

### 2.4. レベル6の特別仕様

ゲーム性を高めるため、レベル6には以下の特別ルールが適用される。

*   **問題数**: 30問
*   **制限時間**: 1問あたり15秒。時間内に回答できないと不正解扱いとなる。
*   **ゲームオーバー**: 5回**連続で**失敗（時間切れ含む）すると、その時点でレッスンが強制的に終了し、結果画面に遷移する。

### 2.5. 進捗管理

*   各レベルのクリア状況（`completed`)と最高正答率 (`accuracy`) は、ブラウザの**ローカルストレージ**に `typingProgress` というキーで保存される。
*   これにより、ユーザーがブラウザを閉じても進捗は維持され、次回アクセス時に復元される。

## 3. 技術仕様

### 3.1. 使用技術

*   **HTML5**: アプリケーションの構造を定義。
*   **CSS3**: スタイリング、レスポンシブデザインを担当。FlexboxやGridを多用。
*   **JavaScript (ES6)**: アプリケーションの全ロジックを制御。クラス構文 (`EducationalTypingApp`) を使用。

### 3.2. ファイル構成

*   `index.html`: HTML本体。
*   `styles.css`: スタイルシート。
*   `script.js`: JavaScriptロジック。
*   `仕様書.md`: このドキュメント。

### 3.3. 主要ロジック (`script.js`)

*   **`EducationalTypingApp` クラス**: アプリケーションの全ての状態と振る舞いを管理する。
    *   `constructor()`: 初期化、イベントリスナーの設定。
    *   `startLesson(lesson)`: 指定されたレッスンの開始処理。
    *   `generateQuestion()`: 新しい問題を生成し、画面に表示する。
    *   `handleTyping(input)`: ユーザーの入力を受け取り、正誤を判定するコアロジック。
    *   `showResult()`: 結果を計算し、結果画面を表示する。
    *   `saveProgress()` / `loadProgress()`: ローカルストレージとのデータ連携。

## 4. 将来の拡張性のためのメモ

*   **新しいレッスンの追加**:
    *   `script.js` の `this.lessons` オブジェクトに新しいレベルの定義を追加する。
    *   `index.html` のレッスン選択画面に、対応するカードを追加する。
*   **テーマの変更**:
    *   主に `styles.css` のカラーコードや背景を変更することで、アプリケーション全体のデザインテーマを容易に変更できる。
*   **外部APIとの連携**:
    *   例えば、ランダムな単語や文章を外部APIから取得するように変更する場合、`generateQuestion` メソッド内の問題取得部分を修正する。
